{ 
  "builders": [
      { "name": "vagrant",
        "type": "virtualbox-iso",
        "boot_command": [
          "<tab> text ks=http://{{ .HTTPIP }}:{{ .HTTPPort }}/ks.cfg<enter><wait>"
        ],
        "boot_wait": "20s",
        "disk_size": 11920,
        "guest_os_type": "RedHat_64",
        "headless": true,
        "http_directory": "http",
        "iso_urls": [
          "CentOS-7-x86_64-Minimal-1908.iso",
          "http://mirrors.mit.edu/centos/7/isos/x86_64/CentOS-7-x86_64-Minimal-1908.iso"
        ],
        "iso_checksum_type": "sha256",
        "iso_checksum": "9a2c47d97b9975452f7d582264e9fc16d108ed8252ac6816239a3b58cef5c53d",
        "ssh_username": "testy",
        "ssh_password": "testpass",
        "ssh_port": 22,
        "ssh_wait_timeout": "10000s",
        "shutdown_command": "echo 'testpass'|sudo -S /sbin/halt -h -p",
        "guest_additions_path": "VBoxGuestAdditions_{{.Version}}.iso",
        "virtualbox_version_file": ".vbox_version",
        "vm_name": "packer-centos-7-x86_64",
        "vboxmanage": [
          [
            "modifyvm",
            "{{.Name}}",
            "--memory",
            "512"
          ],
          [
            "modifyvm",
            "{{.Name}}",
            "--cpus",
            "1"
          ]
        ]
      },
      {
        "name": "openstack",
        "type": "openstack",
          "image_name": "testvnf_image",
          "identity_endpoint": "http://91.106.194.43:5000/v3",
          "username": "vipin",
          "password": "vipin@vnf",
          "ssh_username": "centos",
          "networks" : "438914ab-8c41-4c7e-8a8d-4f8cd521ef6e",
          "source_image": "0ebcaa52-2da4-4a38-95eb-1c06f9759761",
          "flavor": "2420b5c6-7d8f-49d4-9ba4-cf8d2e2e310b",
          "domain_name": "Default",
          "ssh_timeout": "15m",
          "use_floating_ip": "true",
          "floating_ip_network" : "b8d94cc1-84f6-4e4e-b26f-affd1434535f"
   } 
],
  "provisioners": [
    {
      "type": "shell",
      "execute_command": "echo testvnf | {{.Vars}} sudo -S -E bash '{{.Path}}'",
      "script": "scripts/ansible.sh"
    },
    {
      "type": "file",
      "source": "/home/shubham/.ssh/id_rsa.pub",
      "destination": "/home/testvnf/temp",
      "only":["vagrant"]
    },
    {
      "type": "ansible-local",
      "playbook_file": "playbook.yml"
    },
    {
      "type": "file",
      "source": "{{user `ssh_path`}}",
      "destination": "temp"
    },
    {
      "type": "shell",
      "execute_command": "echo testvnf | {{.Vars}} sudo -S -E bash '{{.Path}}'",
      "script": "scripts/cleanup.sh"
    }
  ]
}